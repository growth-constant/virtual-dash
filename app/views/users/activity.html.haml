= render :partial => 'components/title-banner', :locals => {:title => 'Activity'}
%br
.activity-container
  .ui.stackable.centered.grid
    .row
      .five.wide.column
        .activity-left-card
          .content
            .icon-container
              %i.huge.wallet.icon.light-gray
            %br
            %br
            %p.balance= @balance ? "$#{@balance}" : 'N/A'
            %p.title Virtual Dash Balance
            .link-status
              - if @user.stripe_conn_acc_id.nil? 
                .pending 
                  %p Pending link
              - else
                .success
                  %p Linked
            %br
            %p.desc Virtual Dash partners with Stripe to transfer race prize earnings to your bank account.
          - if @user.stripe_conn_acc_id.nil?
            = link_to 'Set up payouts', stripe_connect_path, class: 'ui button fluid light-blue', style: 'border-radius: 0%;'
          - else
            = link_to 'Go to dashboard', stripe_dashboard_path, target: '_blank', class: 'ui button fluid light-blue', style: 'border-radius: 0%;'
        %br
        .activity-left-card
          .content
            .icon-container
              %i.huge.handshake.icon.light-gray
            %br
            %br
            %p.title Need help?
            %p.desc We have written a complete page with FAQs, tips and the support contact.
          = link_to 'Check our help page', help_path, class: 'ui button fluid', style: 'border-radius: 0%;'
      .nine.wide.column 
        .activity-right-card
          %h2 Recent Activity
          = form_with(url: activity_path, method: 'get', local: true) do
            .ui.icon.input.search-bar
              = text_field_tag :name, nil, placeholder: 'Search by race name', value: @race_name == '%%' ? '' : @race_name.gsub('%', '')
              %i.search.icon.gray
            = submit_tag 'Search', class: "ui #{ @race_name == '%%' ? 'dark-blue' : 'light-blue'} button submit-search"
            - unless @race_name == '%%'
              = link_to 'Clear', activity_path, class: 'ui dark-blue button submit-search'
          %table.ui.celled.table.unstackable
            %thead
              %tr
                %th Date
                %th{:colspan => '2'} Description
                %th.center Status
                %th.center Amount
            %tbody
              - @activities.each do | activity |
                %tr
                  %td= activity[:date].strftime('%B %d, %Y')
                  %td{:colspan => '2'}= activity[:description]
                  %td.center
                    - case activity[:status]
                    - when 'OK'
                      = image_tag 'activity/status-ok', alt: 'OK'
                    - when 'PENDING'
                      = image_tag 'activity/status-pending', alt: 'PENDING'
                    - else
                      = image_tag 'activity/status-error', alt: 'ERROR'
                  - if activity[:amount] > 0
                    %td.center
                      .wins= "#{number_to_currency(activity[:amount], precision: 2)} (USD)"
                  - else 
                    %td.center= "#{number_to_currency(activity[:amount], precision: 2)} (USD)"
          -# = render partial: 'paginator', locals: { page: @page, total: @total, url: activity_path }
          = render partial: 'components/paginator', locals: { total: 10, page: 3}